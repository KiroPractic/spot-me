@page "/instructions"
@using Microsoft.AspNetCore.Components.Authorization
@inject NavigationManager Navigation
@inject AuthenticationStateProvider AuthenticationStateProvider
@rendermode InteractiveServer

<PageTitle>SpotMe - Getting Started</PageTitle>

<div class="instructions-container">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="welcome-header text-center mb-5">
                    <h1 class="display-5 fw-bold text-primary mb-3">Welcome to SpotMe! ðŸŽµ</h1>
                    <p class="lead text-muted">Let's get your Spotify data imported so you can explore your music insights</p>
                </div>

                <div class="instruction-card">
                    <div class="card-header bg-primary text-white">
                        <h3 class="card-title mb-0">
                            <i class="bi bi-download me-2"></i>
                            Step 1: Download Your Spotify Data
                        </h3>
                    </div>
                    <div class="card-body">
                        <ol class="instruction-list">
                            <li>
                                <strong>Visit Spotify's Privacy Settings:</strong>
                                <br>
                                Go to <a href="https://www.spotify.com/account/privacy/" target="_blank" class="text-primary">
                                    spotify.com/account/privacy/
                                    <i class="bi bi-box-arrow-up-right ms-1"></i>
                                </a>
                            </li>
                            <li>
                                <strong>Request Your Data:</strong>
                                <br>
                                Scroll down to "Download your data" section and click "Request data download"
                            </li>
                            <li>
                                <strong>Select Extended Streaming History:</strong>
                                <br>
                                Make sure to check "Extended streaming history" - this contains the detailed listening data we need
                            </li>
                            <li>
                                <strong>Wait for the Email:</strong>
                                <br>
                                Spotify will email you when your data is ready (usually takes 1-30 days)
                            </li>
                        </ol>
                    </div>
                </div>

                <div class="instruction-card">
                    <div class="card-header bg-success text-white">
                        <h3 class="card-title mb-0">
                            <i class="bi bi-upload me-2"></i>
                            Step 2: Upload Your Data Files
                        </h3>
                    </div>
                    <div class="card-body">
                        <p class="mb-3">Once you receive your Spotify data:</p>
                        <ol class="instruction-list">
                            <li>Extract the ZIP file you received from Spotify</li>
                            <li>Look for JSON files named like <code>Streaming_History_Audio_YYYY-YYYY_X.json</code></li>
                            <li>Upload these files using our <a href="/userdata" class="text-success">User Data Upload page</a></li>
                        </ol>

                        <div class="upload-action mt-4">
                            <a href="/userdata" class="btn btn-success btn-lg">
                                <i class="bi bi-cloud-upload me-2"></i>
                                Go to Upload Page
                            </a>
                        </div>
                    </div>
                </div>

                <div class="instruction-card">
                    <div class="card-header bg-info text-white">
                        <h3 class="card-title mb-0">
                            <i class="bi bi-graph-up me-2"></i>
                            Step 3: Explore Your Music Insights
                        </h3>
                    </div>
                    <div class="card-body">
                        <p class="mb-3">After uploading your data, you can explore:</p>
                        <div class="row">
                            <div class="col-md-6">
                                <ul class="feature-list">
                                    <li><i class="bi bi-bar-chart text-primary"></i> Detailed listening statistics</li>
                                    <li><i class="bi bi-music-note text-primary"></i> Top tracks and artists</li>
                                    <li><i class="bi bi-calendar text-primary"></i> Listening patterns over time</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <ul class="feature-list">
                                    <li><i class="bi bi-globe text-primary"></i> Geographic listening data</li>
                                    <li><i class="bi bi-clock text-primary"></i> Peak listening hours</li>
                                    <li><i class="bi bi-heart text-primary"></i> Personal music trends</li>
                                </ul>
                            </div>
                        </div>

                        <div class="explore-actions mt-4">
                            <a href="/stats" class="btn btn-info btn-lg me-3">
                                <i class="bi bi-graph-up me-2"></i>
                                View Stats
                            </a>
                            <a href="/playlists" class="btn btn-outline-info btn-lg">
                                <i class="bi bi-music-note-list me-2"></i>
                                Browse Playlists
                            </a>
                        </div>
                    </div>
                </div>

                <div class="help-section text-center mt-5">
                    <div class="alert alert-light border">
                        <h5 class="alert-heading">
                            <i class="bi bi-question-circle me-2"></i>
                            Need Help?
                        </h5>
                        <p class="mb-0">
                            If you're having trouble with any of these steps, feel free to reach out for support. 
                            Your privacy is important to us - all data processing happens locally and securely.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .instructions-container {
        background: linear-gradient(135deg, #121212 0%, #1E1E1E 100%);
        min-height: 100vh;
        padding: 2rem 0;
        color: #ffffff;
    }

    .welcome-header h1 {
        color: #1DB954;
    }

    .welcome-header p {
        color: #b3b3b3;
    }

    .instruction-card {
        background: rgba(0, 0, 0, 0.3);
        border-radius: 12px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
        margin-bottom: 2rem;
        overflow: hidden;
        transition: transform 0.2s ease;
        border: 1px solid #282828;
    }

    .instruction-card:hover {
        transform: translateY(-2px);
        border-color: #1DB954;
    }

    .card-header {
        padding: 1.5rem;
        border-bottom: 1px solid #282828;
    }

    .bg-primary {
        background-color: #1DB954 !important;
    }

    .bg-success {
        background-color: #1DB954 !important;
    }

    .bg-info {
        background-color: #1DB954 !important;
    }

    .card-body {
        padding: 2rem;
        color: #ffffff;
    }

    .card-body p {
        color: #b3b3b3;
    }

    .instruction-list {
        counter-reset: step-counter;
        list-style: none;
        padding-left: 0;
    }

    .instruction-list li {
        counter-increment: step-counter;
        margin-bottom: 1.5rem;
        padding-left: 3rem;
        position: relative;
        color: #ffffff;
    }

    .instruction-list li::before {
        content: counter(step-counter);
        position: absolute;
        left: 0;
        top: 0;
        background: #1DB954;
        color: white;
        width: 2rem;
        height: 2rem;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 0.9rem;
    }

    .feature-list {
        list-style: none;
        padding-left: 0;
    }

    .feature-list li {
        padding: 0.5rem 0;
        display: flex;
        align-items: center;
        color: #ffffff;
    }

    .feature-list li i {
        margin-right: 0.75rem;
        font-size: 1.1rem;
        color: #1DB954;
    }

    .upload-action, .explore-actions {
        text-align: center;
    }

    .btn-lg {
        padding: 12px 30px;
        font-weight: 600;
        border-radius: 50px;
        transition: all 0.2s ease;
        text-decoration: none;
    }

    .btn-success {
        background-color: #1DB954;
        border-color: #1DB954;
        color: #ffffff;
    }

    .btn-success:hover {
        background-color: #1ed760;
        border-color: #1ed760;
        transform: translateY(-1px);
        box-shadow: 0 4px 15px rgba(29, 185, 84, 0.3);
    }

    .btn-info {
        background-color: #1DB954;
        border-color: #1DB954;
        color: #ffffff;
    }

    .btn-info:hover {
        background-color: #1ed760;
        border-color: #1ed760;
        transform: translateY(-1px);
        box-shadow: 0 4px 15px rgba(29, 185, 84, 0.3);
    }

    .btn-outline-info {
        background-color: transparent;
        border-color: #1DB954;
        color: #1DB954;
    }

    .btn-outline-info:hover {
        background-color: rgba(29, 185, 84, 0.1);
        border-color: #1ed760;
        color: #1ed760;
        transform: translateY(-1px);
    }

    code {
        background: #282828;
        padding: 0.2rem 0.5rem;
        border-radius: 4px;
        font-size: 0.9rem;
        color: #1DB954;
        border: 1px solid #404040;
    }

    .alert-light {
        background: rgba(40, 40, 40, 0.8);
        border: 1px solid #404040;
        color: #ffffff;
    }

    .alert-heading {
        color: #1DB954;
    }

    .text-primary {
        color: #1DB954 !important;
    }

    .text-success {
        color: #1DB954 !important;
    }

    @@media (max-width: 768px) {
        .instructions-container {
            padding: 1rem 0;
        }
        
        .card-body {
            padding: 1.5rem;
        }
        
        .btn-lg {
            width: 100%;
            margin-bottom: 1rem;
        }
        
        .explore-actions .btn-lg {
            width: auto;
            margin-bottom: 0.5rem;
        }
    }
</style>

@code {
    protected override async Task OnInitializedAsync()
    {
        // Check if user is authenticated
        var authState = await AuthenticationStateProvider.GetAuthenticationStateAsync();
        if (authState.User.Identity?.IsAuthenticated != true)
        {
            Navigation.NavigateTo("/login");
        }
    }
} 